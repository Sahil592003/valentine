<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For Ashwini ‚ù§Ô∏è</title>

<style>
:root{
  --rose:#ff4d6d;
  --rose-soft:#ffd1dc;
  --rose-light:#fff1f6;
  --card-white:rgba(255,255,255,0.96);
  --text-dark:#444;
  --shadow:0 20px 40px rgba(0,0,0,0.15);
}

body{
  margin:0;
  overflow:hidden;
  background:linear-gradient(135deg,#ffd6e8,#fff1f6);
  font-family:'Segoe UI',sans-serif;
  color:var(--text-dark);
}

/* Envelope */
#envelope{
  position:absolute;
  top:40%;
  left:50%;
  transform:translateX(-50%);
  font-size:120px;
  cursor:pointer;
  filter:drop-shadow(0 8px 15px rgba(0,0,0,0.15));
  transition:transform 2.5s ease;
}
#envelope.opened{
  transform:translateX(-50%) rotateX(180deg) scale(1.15);
}

/* Card */
.card{
  display:none;
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:350px;
  height:480px;
  background:var(--card-white);
  backdrop-filter:blur(6px);
  border-radius:26px;
  box-shadow:var(--shadow);
  padding:26px;
}

.card h2{
  margin:0;
  text-align:center;
  color:var(--rose);
  font-weight:600;
}

/* Text area */
.text-area{
  margin-top:16px;
  height:300px;
  overflow-y:auto;
  font-size:16px;
  line-height:1.9;
  padding-right:6px;
}

/* Cursor */
#cursor{
  color:var(--rose);
  animation:blink 1s infinite;
}
@keyframes blink{
  0%,50%,100%{opacity:1}
  25%,75%{opacity:0}
}

/* Buttons */
button{
  margin-top:18px;
  padding:12px 30px;
  font-size:17px;
  border:none;
  border-radius:30px;
  cursor:pointer;
}
#yes{
  background:linear-gradient(135deg,#ff4d6d,#ff758f);
  color:white;
}
#no{
  background:linear-gradient(135deg,#999,#777);
  color:white;
  position:relative;
}
#replay{
  background:linear-gradient(135deg,#ffd1dc,#ffe6ef);
  color:#333;
}

/* Cloud popups */
.popup{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(255,200,215,0.55);
}
.cloud{
  background:var(--card-white);
  width:300px;
  padding:30px;
  border-radius:70px;
  text-align:center;
  margin:42% auto;
  box-shadow:var(--shadow);
  animation:float 4s ease-in-out infinite;
}
@keyframes float{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-12px)}
}

/* Hearts & petals */
.heart,.petal{
  position:absolute;
  font-size:26px;
  animation:fall 7s linear forwards;
}
@keyframes fall{
  to{top:110%;opacity:0}
}
</style>
</head>

<body>

<!-- Sounds -->
<audio id="openSound" preload="auto">
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_2f6e0b6c98.mp3">
</audio>
<audio id="bgMusic" preload="auto" loop>
  <source src="https://cdn.pixabay.com/audio/2023/03/28/audio_2c7b0e4d5b.mp3">
</audio>
<audio id="typeSound" preload="auto">
  <source src="https://cdn.pixabay.com/audio/2022/10/16/audio_66a07b7c94.mp3">
</audio>

<!-- Envelope -->
<div id="envelope">üíå</div>

<!-- Question Card -->
<div class="card" id="questionCard">
  <h2>Ashwini üíñ</h2>
  <p style="margin-top:22px;text-align:center;">
    Will you be my Valentine? üíå
  </p>
  <div style="text-align:center;">
    <button id="yes">Yes</button>
    <button id="no">No</button>
  </div>
</div>

<!-- Popup 1 -->
<div class="popup" id="p1">
  <div class="cloud">
    ‚òÅÔ∏è Are you sure? ü•∫<br><br>
    <button onclick="closeP1()">Yes</button>
    <button onclick="closeP1()">No</button>
  </div>
</div>

<!-- Popup 2 -->
<div class="popup" id="p2">
  <div class="cloud">
    ‚òÅÔ∏è Still no? üíî<br><br>
    <button onclick="enableRun()">Yes</button>
    <button onclick="enableRun()">No</button>
  </div>
</div>

<!-- Final Card -->
<div class="card" id="finalCard">
  <h2>Ashwini üíó</h2>
  <div class="text-area" id="finalText"></div>
  <span id="cursor">|</span>
  <div style="text-align:center;">
    <button id="replay">üîÅ Replay</button>
  </div>
</div>

<script>
const envelope = document.getElementById("envelope");
const questionCard = document.getElementById("questionCard");
const finalCard = document.getElementById("finalCard");
const finalText = document.getElementById("finalText");
const cursor = document.getElementById("cursor");
const no = document.getElementById("no");

const openSound = document.getElementById("openSound");
const bgMusic = document.getElementById("bgMusic");
const typeSound = document.getElementById("typeSound");

const message = `üå∏ Hey Ashwini,

I know I haven‚Äôt always been perfect.
I know I made mistakes that hurt you üíî

But one thing never changed ‚Äî
my feelings for you ‚ù§Ô∏è

I don‚Äôt promise perfection,
but I promise effort, honesty,
and a heart that chooses you every single day ü§ç

No pressure. No forcing.
Just a genuine heart asking ‚Äî
can we walk this journey together? üíñ`;

envelope.onclick = () => {
  openSound.play();
  bgMusic.volume = 0.25;
  bgMusic.play();
  envelope.classList.add("opened");
  setTimeout(() => {
    envelope.style.display = "none";
    questionCard.style.display = "block";
  }, 2000);
};

no.onclick = () => p1.style.display = "block";
function closeP1(){ p1.style.display = "none"; p2.style.display = "block"; }
function enableRun(){
  p2.style.display = "none";
  no.onmouseover = () => {
    no.style.left = Math.random()*80 + "%";
    no.style.top = Math.random()*80 + "%";
  };
}

document.getElementById("yes").onclick = () => {
  hearts(); petals();
  setTimeout(() => {
    questionCard.style.display = "none";
    finalCard.style.display = "block";
    fadeMusic();
    typeMessage();
  }, 2500);
};

/* üî• FIXED TYPING FUNCTION */
function typeMessage(){
  finalText.innerHTML = "";
  cursor.style.display = "inline";

  let i = 0;
  let currentText = "";

  typeSound.volume = 0.15;
  typeSound.play();

  const interval = setInterval(() => {
    currentText += message[i];
    finalText.innerHTML = currentText.replace(/\n/g,"<br>");
    finalText.scrollTop = finalText.scrollHeight;
    i++;

    if(i >= message.length){
      clearInterval(interval);
      typeSound.pause();
      typeSound.currentTime = 0;
    }
  }, 45);
}

function fadeMusic(){
  const f = setInterval(() => {
    if(bgMusic.volume > 0.02){
      bgMusic.volume -= 0.02;
    }else{
      bgMusic.pause();
      clearInterval(f);
    }
  }, 300);
}

document.getElementById("replay").onclick = () => location.reload();

function hearts(){
  setInterval(() => {
    const h = document.createElement("div");
    h.className = "heart";
    h.innerText = "‚ù§Ô∏è";
    h.style.left = Math.random()*100 + "%";
    h.style.top = "0";
    document.body.appendChild(h);
    setTimeout(() => h.remove(), 7000);
  }, 300);
}
function petals(){
  setInterval(() => {
    const p = document.createElement("div");
    p.className = "petal";
    p.innerText = "üå∏";
    p.style.left = Math.random()*100 + "%";
    p.style.top = "0";
    document.body.appendChild(p);
    setTimeout(() => p.remove(), 7000);
  }, 400);
}
</script>

</body>
</html>
